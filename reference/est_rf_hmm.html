<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Multipoint analysis using Hidden Markov Models in autopolyploids — est_rf_hmm • mappoly</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Multipoint analysis using Hidden Markov Models in autopolyploids — est_rf_hmm"><meta property="og:description" content="Performs the multipoint analysis proposed by Mollinari and
Garcia (2019) in a sequence of markers"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mappoly</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/mappoly_startguide.html">Introduction to MAPpoly</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mmollina/MAPpoly/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Multipoint analysis using Hidden Markov Models in autopolyploids</h1>
    <small class="dont-index">Source: <a href="https://github.com/mmollina/MAPpoly/blob/HEAD/R/est_map_hmm.R" class="external-link"><code>R/est_map_hmm.R</code></a></small>
    <div class="hidden name"><code>est_rf_hmm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Performs the multipoint analysis proposed by <cite>Mollinari and
Garcia (2019)</cite> in a sequence of markers</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">est_rf_hmm</span><span class="op">(</span></span>
<span>  <span class="va">input.seq</span>,</span>
<span>  input.ph <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  thres <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  twopt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  est.given.0.rf <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  reestimate.single.ph.configuration <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  high.prec <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for mappoly.map</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, detailed <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for mappoly.map</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  left.lim <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  right.lim <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  phase <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  mrk.names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  config <span class="op">=</span> <span class="st">"best"</span>,</span>
<span>  P <span class="op">=</span> <span class="st">"Parent 1"</span>,</span>
<span>  Q <span class="op">=</span> <span class="st">"Parent 2"</span>,</span>
<span>  xlim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>input.seq</dt>
<dd><p>an object of class <code>mappoly.sequence</code></p></dd>


<dt>input.ph</dt>
<dd><p>an object of class <code>two.pts.linkage.phases</code>. 
If not available (default = NULL), it will be computed</p></dd>


<dt>thres</dt>
<dd><p>LOD Score threshold used to determine if the linkage phases
compared via two-point analysis should be considered. Smaller 
values will result in smaller number of linkage phase 
configurations to be evaluated by the multipoint algorithm.</p></dd>


<dt>twopt</dt>
<dd><p>an object of class <code>mappoly.twopt</code>
containing two-point information</p></dd>


<dt>verbose</dt>
<dd><p>if <code>TRUE</code>, current progress is shown; if
<code>FALSE</code> (default), no output is produced</p></dd>


<dt>tol</dt>
<dd><p>the desired accuracy (default = 1e-04)</p></dd>


<dt>est.given.0.rf</dt>
<dd><p>logical. If TRUE returns a map forcing all
recombination fractions equals to 0 (1e-5, for internal use only. 
Default = FALSE)</p></dd>


<dt>reestimate.single.ph.configuration</dt>
<dd><p>logical. If <code>TRUE</code>
returns a map without re-estimating the map parameters for cases
where there is only one possible linkage phase configuration. 
This argument is intended to be used in a sequential map construction</p></dd>


<dt>high.prec</dt>
<dd><p>logical. If <code>TRUE</code> (default) uses high precision 
long double numbers in the HMM procedure</p></dd>


<dt>x</dt>
<dd><p>an object of the class <code>mappoly.map</code></p></dd>


<dt>detailed</dt>
<dd><p>logical. if TRUE, prints the linkage phase configuration and the marker 
position for all maps. If FALSE (default), prints a map summary</p></dd>


<dt>...</dt>
<dd><p>currently ignored</p></dd>


<dt>left.lim</dt>
<dd><p>the left limit of the plot (in cM, default = 0).</p></dd>


<dt>right.lim</dt>
<dd><p>the right limit of the plot (in cM, default = Inf, i.e., 
will print the entire map)</p></dd>


<dt>phase</dt>
<dd><p>logical. If <code>TRUE</code> (default) plots the phase configuration
for both parents</p></dd>


<dt>mrk.names</dt>
<dd><p>if TRUE, marker names are displayed (default = FALSE)</p></dd>


<dt>cex</dt>
<dd><p>The magnification to be used for marker names</p></dd>


<dt>config</dt>
<dd><p>should be <code>'best'</code> or the position of the
configuration to be plotted. If <code>'best'</code>, plot the configuration
with the highest likelihood</p></dd>


<dt>P</dt>
<dd><p>a string containing the name of parent P</p></dd>


<dt>Q</dt>
<dd><p>a string containing the name of parent Q</p></dd>


<dt>xlim</dt>
<dd><p>range of the x-axis. If <code>xlim = NULL</code> (default) it uses the 
map range.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list of class <code>mappoly.map</code> with two elements:</p>


<p>i) info:  a list containing information about the map, regardless of the linkage phase configuration:</p>
<dl><dt>ploidy</dt>
<dd><p>the ploidy level</p></dd>

<dt>n.mrk</dt>
<dd><p>number of markers</p></dd>

<dt>seq.num</dt>
<dd><p>a vector containing the (ordered) indices of markers in the map, 
               according to the input file</p></dd>

<dt>mrk.names</dt>
<dd><p>the names of markers in the map</p></dd>

<dt>seq.dose.p1</dt>
<dd><p>a vector containing the dosage in parent 1 for all markers in the map</p></dd>

<dt>seq.dose.p2</dt>
<dd><p>a vector containing the dosage in parent 2 for all markers in the map</p></dd>

<dt>chrom</dt>
<dd><p>a vector indicating the sequence (usually chromosome) each marker belongs 
                as informed in the input file. If not available, 
                <code>chrom = NULL</code></p></dd>

<dt>genome.pos</dt>
<dd><p>physical position (usually in megabase) of the markers into the sequence</p></dd>

<dt>seq.ref</dt>
<dd><p>reference base used for each marker (i.e. A, T, C, G). If not available, 
                <code>seq.ref = NULL</code></p></dd>
                 
<dt>seq.alt</dt>
<dd><p>alternative base used for each marker (i.e. A, T, C, G). If not available, 
                <code>seq.ref = NULL</code></p></dd>

<dt>chisq.pval</dt>
<dd><p>a vector containing p-values of the chi-squared test of Mendelian 
                  segregation for all markers in the map</p></dd>
                 
<dt>data.name</dt>
<dd><p>name of the dataset of class <code>mappoly.data</code></p></dd>

<dt>ph.thres</dt>
<dd><p>the LOD threshold used to define the linkage phase configurations to test</p></dd>


</dl><p>ii) a list of maps with possible linkage phase configuration. Each map in the list is also a 
   list containing</p>
<dl><dt>seq.num</dt>
<dd><p>a vector containing the (ordered) indices of markers in the map, 
               according to the input file</p></dd>

<dt>seq.rf</dt>
<dd><p>a vector of size (<code>n.mrk - 1</code>) containing a sequence of recombination 
              fraction between the adjacent markers in the map</p></dd>

<dt>seq.ph</dt>
<dd><p>linkage phase configuration for all markers in both parents</p></dd>

<dt>loglike</dt>
<dd><p>the hmm-based multipoint likelihood</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function first enumerates a set of linkage phase configurations
 based on two-point recombination fraction information using a threshold
 provided by the user (argument <code>thresh</code>). After that, for each
 configuration, it reconstructs the genetic map using the
 HMM approach described in Mollinari and Garcia (2019). As result, it returns 
 the multipoint likelihood for each configuration in form of LOD Score comparing 
 each configuration to the most likely one. It is recommended to use a small number 
 of markers (e.g. 50 markers for hexaploids) since the possible linkage 
 phase combinations bounded only by the two-point information can be huge. 
 Also, it can be quite sensible to small changes in <code>'thresh'</code>. 
 For a large number of markers, please see <code><a href="est_rf_hmm_sequential.html">est_rf_hmm_sequential</a></code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Mollinari, M., and Garcia, A.  A. F. (2019) Linkage
    analysis and haplotype phasing in experimental autopolyploid
    populations with high ploidy level using hidden Markov
    models, _G3: Genes, Genomes, Genetics_. 
    https://doi.org/10.1534/g3.119.400378</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Marcelo Mollinari, <a href="mailto:mmollin@ncsu.edu">mmollin@ncsu.edu</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>    <span class="va">mrk.subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="make_seq_mappoly.html">make_seq_mappoly</a></span><span class="op">(</span><span class="va">hexafake</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">red.mrk</span> <span class="op">&lt;-</span> <span class="fu"><a href="elim_redundant.html">elim_redundant</a></span><span class="op">(</span><span class="va">mrk.subset</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">unique.mrks</span> <span class="op">&lt;-</span> <span class="fu"><a href="make_seq_mappoly.html">make_seq_mappoly</a></span><span class="op">(</span><span class="va">red.mrk</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">subset.pairs</span> <span class="op">&lt;-</span> <span class="fu"><a href="est_pairwise_rf.html">est_pairwise_rf</a></span><span class="op">(</span>input.seq <span class="op">=</span> <span class="va">unique.mrks</span>,</span></span>
<span class="r-in"><span>                                  ncpus <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                                  verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO: Going singlemode. Using one CPU for calculation.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Also, number of markers is too small to perform parallel computation.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">## Estimating subset map with a low tolerance for the E.M. procedure</span></span></span>
<span class="r-in"><span>    <span class="co">## for CRAN testing purposes</span></span></span>
<span class="r-in"><span>    <span class="va">subset.map</span> <span class="op">&lt;-</span> <span class="fu">est_rf_hmm</span><span class="op">(</span>input.seq <span class="op">=</span> <span class="va">unique.mrks</span>,</span></span>
<span class="r-in"><span>                             thres <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                             twopt <span class="op">=</span> <span class="va">subset.pairs</span>,</span></span>
<span class="r-in"><span>                             verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                             tol <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>                             est.given.0.rf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Listing all configurations under threshold 2 using two-point information...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        2 phase(s): . . </span>
<span class="r-in"><span>    <span class="va">subset.map</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> This is an object of class 'mappoly.map'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Ploidy level:	 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     No. individuals:	 300 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     No. markers:	 9 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     No. linkage phases:	 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ---------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Number of linkage phase configurations:  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ---------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Linkage phase configuration:  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        map length:	 0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        log-likelihood:	 -733.76</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        LOD:		 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ~~~~~~~~~~~~~~~~~~</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Linkage phase configuration:  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        map length:	 6.07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        log-likelihood:	 -983.69</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        LOD:		 -250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ~~~~~~~~~~~~~~~~~~</span>
<span class="r-in"><span>    <span class="co">## linkage phase configuration with highest likelihood</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">subset.map</span>, mrk.names <span class="op">=</span> <span class="cn">TRUE</span>, config <span class="op">=</span> <span class="st">"best"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="est_rf_hmm-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>    <span class="co">## the second one</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">subset.map</span>, mrk.names <span class="op">=</span> <span class="cn">TRUE</span>, config <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="est_rf_hmm-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Marcelo Mollinari, Gabriel Gesteira.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

