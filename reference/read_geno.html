<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Data Input — read_geno • mappoly</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Data Input — read_geno"><meta property="og:description" content="Reads an external data file. The format of the file is described in the Details
section. This function creates an object of class mappoly.data"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mappoly</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/mappoly_startguide.html">Introduction to MAPpoly</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mmollina/MAPpoly/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Data Input</h1>
    <small class="dont-index">Source: <a href="https://github.com/mmollina/MAPpoly/blob/HEAD/R/read_mappoly.R" class="external-link"><code>R/read_mappoly.R</code></a></small>
    <div class="hidden name"><code>read_geno.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Reads an external data file. The format of the file is described in the <code>Details</code>
section. This function creates an object of class <code>mappoly.data</code></p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">read_geno</span><span class="op">(</span></span>
<span>  <span class="va">file.in</span>,</span>
<span>  filter.non.conforming <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  elim.redundant <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for mappoly.data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, detailed <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for mappoly.data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, thresh.line <span class="op">=</span> <span class="fl">1e-05</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>file.in</dt>
<dd><p>a character string with the name of (or full path to) the input file
which contains the data to be read</p></dd>


<dt>filter.non.conforming</dt>
<dd><p>if <code>TRUE</code> (default) converts data points with unexpected 
genotypes (i.e. no double reduction) to 'NA'. See function <code><a href="segreg_poly.html">segreg_poly</a></code> 
for information on expected classes and their respective frequencies.</p></dd>


<dt>elim.redundant</dt>
<dd><p>logical. If <code>TRUE</code> (default), removes redundant markers
during map construction, keeping them annotated to export to the final map.</p></dd>


<dt>verbose</dt>
<dd><p>if <code>TRUE</code> (default), the current progress is shown; if
<code>FALSE</code>, no output is produced</p></dd>


<dt>x</dt>
<dd><p>an object of class <code>mappoly.data</code></p></dd>


<dt>detailed</dt>
<dd><p>if available, print the number of markers per sequence (default = FALSE)</p></dd>


<dt>...</dt>
<dd><p>currently ignored</p></dd>


<dt>thresh.line</dt>
<dd><p>position of a threshold line for p values of the segregation test (default = 10e-06)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of class <code>mappoly.data</code> which contains a
    list with the following components:</p>
<dl><dt>ploidy</dt>
<dd><p>ploidy level</p></dd>

    <dt>n.ind</dt>
<dd><p>number individuals</p></dd>

    <dt>n.mrk</dt>
<dd><p>total number of markers</p></dd>

    <dt>ind.names</dt>
<dd><p>the names of the individuals</p></dd>

    <dt>mrk.names</dt>
<dd><p>the names of the markers</p></dd>

    <dt>dosage.p1</dt>
<dd><p>a vector containing the dosage in
      parent P for all <code>n.mrk</code> markers</p></dd>

    <dt>dosage.p2</dt>
<dd><p>a vector containing the dosage in
      parent Q for all <code>n.mrk</code> markers</p></dd>

    <dt>chrom</dt>
<dd><p>a vector indicating which sequence each marker
      belongs. Zero indicates that the marker was not assigned to any
      sequence</p></dd>

    <dt>genome.pos</dt>
<dd><p>Physical position of the markers into the
      sequence</p></dd>

    <dt>seq.ref</dt>
<dd><p>NULL (unused in this type of data)</p></dd>

    <dt>seq.alt</dt>
<dd><p>NULL (unused in this type of data)</p></dd>

    <dt>all.mrk.depth</dt>
<dd><p>NULL (unused in this type of data)</p></dd>

    <dt>geno.dose</dt>
<dd><p>a matrix containing the dosage for each markers (rows) 
      for each individual (columns). Missing data are represented by 
      <code>ploidy_level + 1</code></p></dd>

    <dt>n.phen</dt>
<dd><p>number of phenotypic traits</p></dd>

    <dt>phen</dt>
<dd><p>a matrix containing the phenotypic data. The rows
                correspond to the traits and the columns correspond
                to the individuals</p></dd>

    <dt>kept</dt>
<dd><p>if elim.redundant = TRUE, holds all non-redundant markers</p></dd>

    <dt>elim.correspondence</dt>
<dd><p>if elim.redundant = TRUE, holds all non-redundant markers and
its equivalence to the redundant ones</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The first line of the input file contains the string <code>ploidy</code> followed by the ploidy level of the parents.
The second and third lines contain the strings <code>n.ind</code> and <code>n.mrk</code> followed by the number of individuals in 
the dataset and the total number of markers, respectively. Lines number 4 and 5 contain the strings
<code>mrk.names</code> and <code>ind.names</code> followed by a sequence of the names of the markers and the name of the individuals, 
respectively. Lines 6 and 7 contain the strings <code>dosageP</code> and <code>dosageQ</code> followed by a sequence of numbers 
containing the dosage of all markers in parent <code>P</code> and <code>Q</code>. Line 8, contains the string seq followed by 
a sequence of integer numbers indicating the chromosome each marker belongs. It can be any 'a priori' 
information regarding the physical distance between markers. For example, these numbers could refer 
to chromosomes, scaffolds or even contigs, in which the markers are positioned. If this information 
is not available for a particular marker, NA should be used. If this information is not available for 
any of the markers, the string <code>seq</code> should be followed by a single <code>NA</code>. Line number 9 contains the string 
<code>seqpos</code> followed by the physical position of the markers into the sequence. The physical position can be 
given in any unity of physical genomic distance (base pairs, for instance). However, the user should be 
able to make decisions based on these values, such as the occurrence of crossing overs, etc. Line number 10 
should contain the string <code>nphen</code> followed by the number of phenotypic traits. Line number 11 is skipped 
(Usually used as a spacer). The next elements are strings containing the name of the phenotypic trait with no space characters
followed by the phenotypic values. The number of lines should be the same number of phenotypic traits. 
<code>NA</code> represents missing values. The line number 12 + <code>nphen</code> is skipped. Finally, the last element is a table
containing the dosage for each marker (rows) for each individual (columns). <code>NA</code> represents missing values.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Mollinari M., Olukolu B. A.,  Pereira G. da S., 
    Khan A., Gemenet D., Yencho G. C., Zeng Z-B. (2020), 
    Unraveling the Hexaploid Sweetpotato Inheritance 
    Using Ultra-Dense Multilocus Mapping, 
    _G3: Genes, Genomes, Genetics_. 
    doi: <a href="https://doi.org/10.1534/g3.119.400620" class="external-link">10.1534/g3.119.400620</a></p>    
<p>Mollinari, M., and Garcia, A.  A. F. (2019) Linkage
    analysis and haplotype phasing in experimental autopolyploid
    populations with high ploidy level using hidden Markov
    models, _G3: Genes, Genomes, Genetics_. 
    doi: <a href="https://doi.org/10.1534/g3.119.400378" class="external-link">10.1534/g3.119.400378</a></p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Marcelo Mollinari, <a href="mailto:mmollin@ncsu.edu">mmollin@ncsu.edu</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">#### Tetraploid Example</span></span></span>
<span class="r-in"><span><span class="va">fl1</span> <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/mmollina/MAPpoly_vignettes/master/data/SolCAP_dosage"</span></span></span>
<span class="r-in"><span><span class="va">tempfl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span><span class="va">fl1</span>, destfile <span class="op">=</span> <span class="va">tempfl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">SolCAP.dose</span> <span class="op">&lt;-</span> <span class="fu">read_geno</span><span class="op">(</span>file.in  <span class="op">=</span> <span class="va">tempfl</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reading the following data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Ploidy level: 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     No. individuals:  160</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     No. markers:  4017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     No. informative markers:  4017 (100%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Done with reading.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Filtering non-conforming markers.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Performing chi-square test.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Done.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">SolCAP.dose</span>, detailed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> This is an object of class 'mappoly.data'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Ploidy level:                            4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     No. individuals:                         160 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     No. markers:                             3679 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Missing data:                            3.18%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Redundant markers:                       8.41%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     No. markers per chromosome:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        seq No.mrk</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1    391</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          2    269</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          3    290</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          4    387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          5    275</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          6    394</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          7    345</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          8    263</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          9    282</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         10    224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         11    252</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         12    215</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Markers with no chromosome information: 92</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     No. of markers per dosage combination in both parents:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     P1 P2 freq</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      0  1  332</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      0  2  169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      0  3   24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1  0  339</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1  1  307</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1  2  255</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1  3  123</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1  4   12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2  0  166</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2  1  212</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2  2  336</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2  3  195</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2  4   49</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      3  0   41</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      3  1  110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      3  2  202</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      3  3  202</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      3  4  263</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      4  1    9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      4  2   85</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      4  3  248</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">SolCAP.dose</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="read_geno-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Marcelo Mollinari, Gabriel Gesteira.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

